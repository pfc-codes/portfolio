---
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
  const projects = await getCollection("projects");
  return projects.map((project) => ({
    params: { id: project.id },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await render(project);
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>{project.data.title}</title>
  </head>
  <body style="font-family: system-ui; max-width: 760px; margin: 0 auto; padding: 32px;">
    <p style="opacity:.6">
      {project.data.category} • {project.data.date.toLocaleDateString()}
    </p>

    <h1 style="margin: 8px 0 8px 0;">{project.data.title}</h1>
    <p style="opacity:.85; margin-top: 0;">{project.data.summary}</p>

    <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:18px; opacity:.85;">
      {project.data.role && <span><b>Role:</b> {project.data.role}</span>}
      {project.data.client && <span><b>Client:</b> {project.data.client}</span>}
    </div>

    {project.data.tools?.length > 0 && (
      <p style="margin-top:14px; opacity:.85;">
        <b>Tools:</b> {project.data.tools.join(" • ")}
      </p>
    )}

    {project.data.video && (
      <div style="margin-top:24px; aspect-ratio: 16/9;">
        <iframe
          style="width:100%; height:100%; border:1px solid #ddd; border-radius:12px;"
          src={project.data.video}
          allow="autoplay; fullscreen; picture-in-picture"
        />
      </div>
    )}

    <div style="margin-top:28px; line-height:1.75;">
      <Content />
    </div>

    <p style="margin-top:48px;">
      <a href="/work/">← Back to Work</a>
    </p>
  </body>
</html>
